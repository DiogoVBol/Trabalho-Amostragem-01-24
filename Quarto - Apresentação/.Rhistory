ic_upper_amostra_2 <- media_amostra_2 + qt(0.95, df = 9) * sd_amostra_2 / sqrt(10)
# Adicionar amostra específica ao dataframe
df_plot <- rbind(df_plot, data.frame(
Amostra = "Amostra Específica",
Media = media_amostra_2,
IC_Lower = ic_lower_amostra_2,
IC_Upper = ic_upper_amostra_2
))
# Definir o limite comum para o eixo x
x_limits <- c(0, 65)
# Gráfico de densidade
p1 <- ggplot(df, aes(x = quant_artigos)) +
geom_histogram(aes(y = ..density..), fill = "tomato", color = "black", size = 0.5, bins = 50) +
geom_vline(xintercept = media_verdadeira, linetype = "dashed", color = "red", size = 1) +
theme_minimal() +
labs(x = NULL, y = NULL) +
coord_cartesian(xlim = x_limits) +
theme(panel.grid = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) +
annotate("text", x = 40, y = 0.058, label = "Média população\nde Pesquisa: 28.10", size = 3, color = "black") +
annotate("curve", x = 36, xend = media_verdadeira, y = 0.03, yend = 0.045,
curvature = 0.2,
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "black")
# Gráfico das médias e ICs
p2 <- ggplot(df_plot, aes(x = Amostra, y = Media)) +
geom_point(size = 3, color = ifelse(df_plot$Amostra == "Amostra Específica", "blue", "black")) +
geom_errorbar(aes(ymin = IC_Lower, ymax = IC_Upper), width = 0.2, color = ifelse(df_plot$Amostra == "Amostra Específica", "blue", "black")) +
geom_hline(yintercept = media_verdadeira, linetype = "dashed", color = "red", size = 1) +
coord_flip() +
scale_y_continuous(limits = x_limits) +
labs(x = NULL, y = NULL) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) +
annotate("text", x = 15, y = 54, label = "Nossa amostra!\nMédia de 15.6", size = 3, color = "black") +
annotate("curve", x = 15, xend = 15, y = 50, yend = 36,
curvature = -0.14,
arrow = arrow(type = "closed", length = unit(0.09, "inches")),
color = "black")
# Combinar os gráficos
grid.arrange(p1, p2, ncol = 1, heights = c(1, 2))
set.seed(12345)
media_verdadeira <- mean(df$quant_artigos)
# Gerar amostras e calcular médias e ICs
amostras <- replicate(14, sample(df$quant_artigos, 10, replace = TRUE))
medias <- apply(amostras, 2, mean)
sds <- apply(amostras, 2, sd)
ic_lower <- medias - qt(0.95, df = 9) * sds / sqrt(10)
ic_upper <- medias + qt(0.95, df = 9) * sds / sqrt(10)
# Criar dataframe para o segundo gráfico
df_plot <- data.frame(
Amostra = factor(1:14),
Media = medias,
IC_Lower = ic_lower,
IC_Upper = ic_upper
)
# Gerar amostra específica
aass_amostra_2 <- sample(x = seq_len(nrow(df)), size = 10, replace = FALSE)
media_amostra_2 <- mean(df$quant_artigos[aass_amostra_2])
sd_amostra_2 <- sd(df$quant_artigos[aass_amostra_2])
ic_lower_amostra_2 <- media_amostra_2 - qt(0.95, df = 9) * sd_amostra_2 / sqrt(10)
ic_upper_amostra_2 <- media_amostra_2 + qt(0.95, df = 9) * sd_amostra_2 / sqrt(10)
# Adicionar amostra específica ao dataframe
df_plot <- rbind(df_plot, data.frame(
Amostra = "Amostra Específica",
Media = media_amostra_2,
IC_Lower = ic_lower_amostra_2,
IC_Upper = ic_upper_amostra_2
))
# Definir o limite comum para o eixo x
x_limits <- c(0, 65)
# Gráfico de densidade
p1 <- ggplot(df, aes(x = quant_artigos)) +
geom_histogram(aes(y = ..density..), fill = "tomato", color = "black", size = 0.5, bins = 50) +
geom_vline(xintercept = media_verdadeira, linetype = "dashed", color = "red", size = 1) +
theme_minimal() +
labs(x = NULL, y = NULL) +
coord_cartesian(xlim = x_limits) +
theme(panel.grid = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) +
annotate("text", x = 40, y = 0.058, label = "Média população\nde Pesquisa: 28.10", size = 3, color = "black") +
annotate("curve", x = 36, xend = media_verdadeira, y = 0.045, yend = 0.03,
curvature = 0.2,
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "black")
# Gráfico das médias e ICs
p2 <- ggplot(df_plot, aes(x = Amostra, y = Media)) +
geom_point(size = 3, color = ifelse(df_plot$Amostra == "Amostra Específica", "blue", "black")) +
geom_errorbar(aes(ymin = IC_Lower, ymax = IC_Upper), width = 0.2, color = ifelse(df_plot$Amostra == "Amostra Específica", "blue", "black")) +
geom_hline(yintercept = media_verdadeira, linetype = "dashed", color = "red", size = 1) +
coord_flip() +
scale_y_continuous(limits = x_limits) +
labs(x = NULL, y = NULL) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) +
annotate("text", x = 15, y = 54, label = "Nossa amostra!\nMédia de 15.6", size = 3, color = "black") +
annotate("curve", x = 15, xend = 15, y = 50, yend = 36,
curvature = -0.14,
arrow = arrow(type = "closed", length = unit(0.09, "inches")),
color = "black")
# Combinar os gráficos
grid.arrange(p1, p2, ncol = 1, heights = c(1, 2))
set.seed(12345)
media_verdadeira <- mean(df$quant_artigos)
# Gerar amostras e calcular médias e ICs
amostras <- replicate(14, sample(df$quant_artigos, 10, replace = TRUE))
medias <- apply(amostras, 2, mean)
sds <- apply(amostras, 2, sd)
ic_lower <- medias - qt(0.95, df = 9) * sds / sqrt(10)
ic_upper <- medias + qt(0.95, df = 9) * sds / sqrt(10)
# Criar dataframe para o segundo gráfico
df_plot <- data.frame(
Amostra = factor(1:14),
Media = medias,
IC_Lower = ic_lower,
IC_Upper = ic_upper
)
# Gerar amostra específica
aass_amostra_2 <- sample(x = seq_len(nrow(df)), size = 10, replace = FALSE)
media_amostra_2 <- mean(df$quant_artigos[aass_amostra_2])
sd_amostra_2 <- sd(df$quant_artigos[aass_amostra_2])
ic_lower_amostra_2 <- media_amostra_2 - qt(0.95, df = 9) * sd_amostra_2 / sqrt(10)
ic_upper_amostra_2 <- media_amostra_2 + qt(0.95, df = 9) * sd_amostra_2 / sqrt(10)
# Adicionar amostra específica ao dataframe
df_plot <- rbind(df_plot, data.frame(
Amostra = "Amostra Específica",
Media = media_amostra_2,
IC_Lower = ic_lower_amostra_2,
IC_Upper = ic_upper_amostra_2
))
# Definir o limite comum para o eixo x
x_limits <- c(0, 65)
# Gráfico de densidade
p1 <- ggplot(df, aes(x = quant_artigos)) +
geom_histogram(aes(y = ..density..), fill = "tomato", color = "black", size = 0.5, bins = 50) +
geom_vline(xintercept = media_verdadeira, linetype = "dashed", color = "red", size = 1) +
theme_minimal() +
labs(x = NULL, y = NULL) +
coord_cartesian(xlim = x_limits) +
theme(panel.grid = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) +
annotate("text", x = 40, y = 0.058, label = "Média população\nde Pesquisa: 28.10", size = 3, color = "black") +
annotate("curve", x = 36, xend = media_verdadeira, y = 0.045, yend = 0.03,
curvature = -0.2,
arrow = arrow(type = "closed", length = unit(0.1, "inches")),
color = "black")
# Gráfico das médias e ICs
p2 <- ggplot(df_plot, aes(x = Amostra, y = Media)) +
geom_point(size = 3, color = ifelse(df_plot$Amostra == "Amostra Específica", "blue", "black")) +
geom_errorbar(aes(ymin = IC_Lower, ymax = IC_Upper), width = 0.2, color = ifelse(df_plot$Amostra == "Amostra Específica", "blue", "black")) +
geom_hline(yintercept = media_verdadeira, linetype = "dashed", color = "red", size = 1) +
coord_flip() +
scale_y_continuous(limits = x_limits) +
labs(x = NULL, y = NULL) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) +
annotate("text", x = 15, y = 54, label = "Nossa amostra!\nMédia de 15.6", size = 3, color = "black") +
annotate("curve", x = 15, xend = 15, y = 50, yend = 36,
curvature = -0.14,
arrow = arrow(type = "closed", length = unit(0.09, "inches")),
color = "black")
# Combinar os gráficos
grid.arrange(p1, p2, ncol = 1, heights = c(1, 2))
set.seed(12345)
media_verdadeira <- mean(df$quant_artigos)
# Gerar amostras e calcular médias e ICs
amostras <- replicate(14, sample(df$quant_artigos, 10, replace = TRUE))
medias <- apply(amostras, 2, mean)
sds <- apply(amostras, 2, sd)
ic_lower <- medias - qt(0.95, df = 9) * sds / sqrt(10)
ic_upper <- medias + qt(0.95, df = 9) * sds / sqrt(10)
# Criar dataframe para o segundo gráfico
df_plot <- data.frame(
Amostra = factor(1:14),
Media = medias,
IC_Lower = ic_lower,
IC_Upper = ic_upper
)
# Gerar amostra específica
aass_amostra_2 <- sample(x = seq_len(nrow(df)), size = 10, replace = FALSE)
media_amostra_2 <- mean(df$quant_artigos[aass_amostra_2])
sd_amostra_2 <- sd(df$quant_artigos[aass_amostra_2])
ic_lower_amostra_2 <- media_amostra_2 - qt(0.95, df = 9) * sd_amostra_2 / sqrt(10)
ic_upper_amostra_2 <- media_amostra_2 + qt(0.95, df = 9) * sd_amostra_2 / sqrt(10)
# Adicionar amostra específica ao dataframe
df_plot <- rbind(df_plot, data.frame(
Amostra = "Amostra Específica",
Media = media_amostra_2,
IC_Lower = ic_lower_amostra_2,
IC_Upper = ic_upper_amostra_2
))
# Definir o limite comum para o eixo x
x_limits <- c(0, 65)
# Gráfico de densidade
p1 <- ggplot(df, aes(x = quant_artigos)) +
geom_histogram(aes(y = ..density..), fill = "tomato", color = "black", size = 0.5, bins = 50) +
geom_vline(xintercept = media_verdadeira, linetype = "dashed", color = "red", size = 1) +
theme_minimal() +
labs(x = NULL, y = NULL) +
coord_cartesian(xlim = x_limits) +
theme(panel.grid = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) +
annotate("text", x = 40, y = 0.058, label = "Média população\nde Pesquisa: 28.10", size = 3, color = "black") +
annotate("curve", x = 36, xend = media_verdadeira, y = 0.045, yend = 0.03,
curvature = -0.2,
arrow = arrow(type = "closed", length = unit(0.09, "inches")),
color = "black")
# Gráfico das médias e ICs
p2 <- ggplot(df_plot, aes(x = Amostra, y = Media)) +
geom_point(size = 3, color = ifelse(df_plot$Amostra == "Amostra Específica", "blue", "black")) +
geom_errorbar(aes(ymin = IC_Lower, ymax = IC_Upper), width = 0.2, color = ifelse(df_plot$Amostra == "Amostra Específica", "blue", "black")) +
geom_hline(yintercept = media_verdadeira, linetype = "dashed", color = "red", size = 1) +
coord_flip() +
scale_y_continuous(limits = x_limits) +
labs(x = NULL, y = NULL) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) +
annotate("text", x = 15, y = 54, label = "Nossa amostra!\nMédia de 15.6", size = 3, color = "black") +
annotate("curve", x = 15, xend = 15, y = 50, yend = 36,
curvature = -0.14,
arrow = arrow(type = "closed", length = unit(0.09, "inches")),
color = "black")
# Combinar os gráficos
grid.arrange(p1, p2, ncol = 1, heights = c(1, 2))
set.seed(12345)
media_verdadeira <- mean(df$quant_artigos)
# Gerar amostras e calcular médias e ICs
amostras <- replicate(14, sample(df$quant_artigos, 10, replace = TRUE))
medias <- apply(amostras, 2, mean)
sds <- apply(amostras, 2, sd)
ic_lower <- medias - qt(0.95, df = 9) * sds / sqrt(10)
ic_upper <- medias + qt(0.95, df = 9) * sds / sqrt(10)
# Criar dataframe para o segundo gráfico
df_plot <- data.frame(
Amostra = factor(1:14),
Media = medias,
IC_Lower = ic_lower,
IC_Upper = ic_upper
)
# Gerar amostra específica
aass_amostra_2 <- sample(x = seq_len(nrow(df)), size = 10, replace = FALSE)
media_amostra_2 <- mean(df$quant_artigos[aass_amostra_2])
sd_amostra_2 <- sd(df$quant_artigos[aass_amostra_2])
ic_lower_amostra_2 <- media_amostra_2 - qt(0.95, df = 9) * sd_amostra_2 / sqrt(10)
ic_upper_amostra_2 <- media_amostra_2 + qt(0.95, df = 9) * sd_amostra_2 / sqrt(10)
# Adicionar amostra específica ao dataframe
df_plot <- rbind(df_plot, data.frame(
Amostra = "Amostra Específica",
Media = media_amostra_2,
IC_Lower = ic_lower_amostra_2,
IC_Upper = ic_upper_amostra_2
))
# Definir o limite comum para o eixo x
x_limits <- c(0, 65)
# Gráfico de densidade
p1 <- ggplot(df, aes(x = quant_artigos)) +
geom_histogram(aes(y = ..density..), fill = "tomato", color = "black", size = 0.5, bins = 50) +
geom_vline(xintercept = media_verdadeira, linetype = "dashed", color = "red", size = 1) +
theme_minimal() +
labs(x = NULL, y = NULL) +
coord_cartesian(xlim = x_limits) +
theme(panel.grid = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) +
annotate("text", x = 40, y = 0.058, label = "Média população\nde Pesquisa: 28.10", size = 3, color = "black") +
annotate("curve", x = 36, xend = media_verdadeira-1, y = 0.045, yend = 0.03,
curvature = -0.2,
arrow = arrow(type = "closed", length = unit(0.09, "inches")),
color = "black")
# Gráfico das médias e ICs
p2 <- ggplot(df_plot, aes(x = Amostra, y = Media)) +
geom_point(size = 3, color = ifelse(df_plot$Amostra == "Amostra Específica", "blue", "black")) +
geom_errorbar(aes(ymin = IC_Lower, ymax = IC_Upper), width = 0.2, color = ifelse(df_plot$Amostra == "Amostra Específica", "blue", "black")) +
geom_hline(yintercept = media_verdadeira, linetype = "dashed", color = "red", size = 1) +
coord_flip() +
scale_y_continuous(limits = x_limits) +
labs(x = NULL, y = NULL) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) +
annotate("text", x = 15, y = 54, label = "Nossa amostra!\nMédia de 15.6", size = 3, color = "black") +
annotate("curve", x = 15, xend = 15, y = 50, yend = 36,
curvature = -0.14,
arrow = arrow(type = "closed", length = unit(0.09, "inches")),
color = "black")
# Combinar os gráficos
grid.arrange(p1, p2, ncol = 1, heights = c(1, 2))
set.seed(12345)
media_verdadeira <- mean(df$quant_artigos)
# Gerar amostras e calcular médias e ICs
amostras <- replicate(14, sample(df$quant_artigos, 10, replace = TRUE))
medias <- apply(amostras, 2, mean)
sds <- apply(amostras, 2, sd)
ic_lower <- medias - qt(0.95, df = 9) * sds / sqrt(10)
ic_upper <- medias + qt(0.95, df = 9) * sds / sqrt(10)
# Criar dataframe para o segundo gráfico
df_plot <- data.frame(
Amostra = factor(1:14),
Media = medias,
IC_Lower = ic_lower,
IC_Upper = ic_upper
)
# Gerar amostra específica
aass_amostra_2 <- sample(x = seq_len(nrow(df)), size = 10, replace = FALSE)
media_amostra_2 <- mean(df$quant_artigos[aass_amostra_2])
sd_amostra_2 <- sd(df$quant_artigos[aass_amostra_2])
ic_lower_amostra_2 <- media_amostra_2 - qt(0.95, df = 9) * sd_amostra_2 / sqrt(10)
ic_upper_amostra_2 <- media_amostra_2 + qt(0.95, df = 9) * sd_amostra_2 / sqrt(10)
# Adicionar amostra específica ao dataframe
df_plot <- rbind(df_plot, data.frame(
Amostra = "Amostra Específica",
Media = media_amostra_2,
IC_Lower = ic_lower_amostra_2,
IC_Upper = ic_upper_amostra_2
))
# Definir o limite comum para o eixo x
x_limits <- c(0, 65)
# Gráfico de densidade
p1 <- ggplot(df, aes(x = quant_artigos)) +
geom_histogram(aes(y = ..density..), fill = "tomato", color = "black", size = 0.5, bins = 50) +
geom_vline(xintercept = media_verdadeira, linetype = "dashed", color = "red", size = 1) +
theme_minimal() +
labs(x = NULL, y = NULL) +
coord_cartesian(xlim = x_limits) +
theme(panel.grid = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) +
annotate("text", x = 40, y = 0.058, label = "Média população\nde Pesquisa: 28.10", size = 3, color = "black") +
annotate("curve", x = 36, xend = media_verdadeira+1, y = 0.045, yend = 0.03,
curvature = -0.2,
arrow = arrow(type = "closed", length = unit(0.09, "inches")),
color = "black")
# Gráfico das médias e ICs
p2 <- ggplot(df_plot, aes(x = Amostra, y = Media)) +
geom_point(size = 3, color = ifelse(df_plot$Amostra == "Amostra Específica", "blue", "black")) +
geom_errorbar(aes(ymin = IC_Lower, ymax = IC_Upper), width = 0.2, color = ifelse(df_plot$Amostra == "Amostra Específica", "blue", "black")) +
geom_hline(yintercept = media_verdadeira, linetype = "dashed", color = "red", size = 1) +
coord_flip() +
scale_y_continuous(limits = x_limits) +
labs(x = NULL, y = NULL) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) +
annotate("text", x = 15, y = 54, label = "Nossa amostra!\nMédia de 15.6", size = 3, color = "black") +
annotate("curve", x = 15, xend = 15, y = 50, yend = 36,
curvature = -0.14,
arrow = arrow(type = "closed", length = unit(0.09, "inches")),
color = "black")
# Combinar os gráficos
grid.arrange(p1, p2, ncol = 1, heights = c(1, 2))
set.seed(12345)
media_verdadeira <- mean(df$quant_artigos)
# Gerar amostras e calcular médias e ICs
amostras <- replicate(14, sample(df$quant_artigos, 10, replace = TRUE))
medias <- apply(amostras, 2, mean)
sds <- apply(amostras, 2, sd)
ic_lower <- medias - qt(0.95, df = 9) * sds / sqrt(10)
ic_upper <- medias + qt(0.95, df = 9) * sds / sqrt(10)
# Criar dataframe para o segundo gráfico
df_plot <- data.frame(
Amostra = factor(1:14),
Media = medias,
IC_Lower = ic_lower,
IC_Upper = ic_upper
)
# Gerar amostra específica
aass_amostra_2 <- sample(x = seq_len(nrow(df)), size = 10, replace = FALSE)
media_amostra_2 <- mean(df$quant_artigos[aass_amostra_2])
sd_amostra_2 <- sd(df$quant_artigos[aass_amostra_2])
ic_lower_amostra_2 <- media_amostra_2 - qt(0.95, df = 9) * sd_amostra_2 / sqrt(10)
ic_upper_amostra_2 <- media_amostra_2 + qt(0.95, df = 9) * sd_amostra_2 / sqrt(10)
# Adicionar amostra específica ao dataframe
df_plot <- rbind(df_plot, data.frame(
Amostra = "Amostra Específica",
Media = media_amostra_2,
IC_Lower = ic_lower_amostra_2,
IC_Upper = ic_upper_amostra_2
))
# Definir o limite comum para o eixo x
x_limits <- c(0, 65)
# Gráfico de densidade
p1 <- ggplot(df, aes(x = quant_artigos)) +
geom_histogram(aes(y = ..density..), fill = "tomato", color = "black", size = 0.5, bins = 50) +
geom_vline(xintercept = media_verdadeira, linetype = "dashed", color = "red", size = 1) +
theme_minimal() +
labs(x = NULL, y = NULL) +
coord_cartesian(xlim = x_limits) +
theme(panel.grid = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) +
annotate("text", x = 40, y = 0.058, label = "Média população\nde Pesquisa: 28.10", size = 3, color = "black") +
annotate("curve", x = 36, xend = media_verdadeira+0.5, y = 0.045, yend = 0.03,
curvature = -0.2,
arrow = arrow(type = "closed", length = unit(0.09, "inches")),
color = "black")
# Gráfico das médias e ICs
p2 <- ggplot(df_plot, aes(x = Amostra, y = Media)) +
geom_point(size = 3, color = ifelse(df_plot$Amostra == "Amostra Específica", "blue", "black")) +
geom_errorbar(aes(ymin = IC_Lower, ymax = IC_Upper), width = 0.2, color = ifelse(df_plot$Amostra == "Amostra Específica", "blue", "black")) +
geom_hline(yintercept = media_verdadeira, linetype = "dashed", color = "red", size = 1) +
coord_flip() +
scale_y_continuous(limits = x_limits) +
labs(x = NULL, y = NULL) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) +
annotate("text", x = 15, y = 54, label = "Nossa amostra!\nMédia de 15.6", size = 3, color = "black") +
annotate("curve", x = 15, xend = 15, y = 50, yend = 36,
curvature = -0.14,
arrow = arrow(type = "closed", length = unit(0.09, "inches")),
color = "black")
# Combinar os gráficos
grid.arrange(p1, p2, ncol = 1, heights = c(1, 2))
set.seed(12345)
media_verdadeira <- mean(df$quant_artigos)
# Gerar amostras e calcular médias e ICs
amostras <- replicate(14, sample(df$quant_artigos, 10, replace = FALSE))
medias <- apply(amostras, 2, mean)
sds <- apply(amostras, 2, sd)
ic_lower <- medias - qt(0.95, df = 9) * sds / sqrt(10)
ic_upper <- medias + qt(0.95, df = 9) * sds / sqrt(10)
# Criar dataframe para o segundo gráfico
df_plot <- data.frame(
Amostra = factor(1:14),
Media = medias,
IC_Lower = ic_lower,
IC_Upper = ic_upper
)
# Gerar amostra específica
aass_amostra_2 <- sample(x = seq_len(nrow(df)), size = 10, replace = FALSE)
media_amostra_2 <- mean(df$quant_artigos[aass_amostra_2])
sd_amostra_2 <- sd(df$quant_artigos[aass_amostra_2])
ic_lower_amostra_2 <- media_amostra_2 - qt(0.95, df = 9) * sd_amostra_2 / sqrt(10)
ic_upper_amostra_2 <- media_amostra_2 + qt(0.95, df = 9) * sd_amostra_2 / sqrt(10)
# Adicionar amostra específica ao dataframe
df_plot <- rbind(df_plot, data.frame(
Amostra = "Amostra Específica",
Media = media_amostra_2,
IC_Lower = ic_lower_amostra_2,
IC_Upper = ic_upper_amostra_2
))
# Definir o limite comum para o eixo x
x_limits <- c(0, 65)
# Gráfico de densidade
p1 <- ggplot(df, aes(x = quant_artigos)) +
geom_histogram(aes(y = ..density..), fill = "tomato", color = "black", size = 0.5, bins = 50) +
geom_vline(xintercept = media_verdadeira, linetype = "dashed", color = "red", size = 1) +
theme_minimal() +
labs(x = NULL, y = NULL) +
coord_cartesian(xlim = x_limits) +
theme(panel.grid = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) +
annotate("text", x = 40, y = 0.058, label = "Média população\nde Pesquisa: 28.10", size = 3, color = "black") +
annotate("curve", x = 36, xend = media_verdadeira+0.5, y = 0.045, yend = 0.03,
curvature = -0.2,
arrow = arrow(type = "closed", length = unit(0.09, "inches")),
color = "black")
# Gráfico das médias e ICs
p2 <- ggplot(df_plot, aes(x = Amostra, y = Media)) +
geom_point(size = 3, color = ifelse(df_plot$Amostra == "Amostra Específica", "blue", "black")) +
geom_errorbar(aes(ymin = IC_Lower, ymax = IC_Upper), width = 0.2, color = ifelse(df_plot$Amostra == "Amostra Específica", "blue", "black")) +
geom_hline(yintercept = media_verdadeira, linetype = "dashed", color = "red", size = 1) +
coord_flip() +
scale_y_continuous(limits = x_limits) +
labs(x = NULL, y = NULL) +
theme_minimal() +
theme(panel.grid = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_blank()) +
annotate("text", x = 15, y = 54, label = "Nossa amostra!\nMédia de 15.6", size = 3, color = "black") +
annotate("curve", x = 15, xend = 15, y = 50, yend = 36,
curvature = -0.14,
arrow = arrow(type = "closed", length = unit(0.09, "inches")),
color = "black")
# Combinar os gráficos
grid.arrange(p1, p2, ncol = 1, heights = c(1, 2))
# documentação do quarto: https://quarto.org/docs/presentations/revealjs/
library(tidyverse)
library(readxl)
library(grid)
library(png)
library(showtext)
library(knitr)
library(kableExtra)
library(survey)
library(presize)
library(RcppAlgos)
library(gridExtra)
set.seed(12345)
db        <- read_excel("../data/artigos.xlsx")
# Alocando em vetores para facilitar a leitura
v_nomes   <- db$nome
v_artigos <- db$quant_artigos
set.seed(12345)
# # Coletando uma amostra de tamanho 10 para obter informações sobre o desvio padrão populacional
aass_amostra_2 <- sample(x = seq_len(nrow(df)), size = 10, replace = FALSE)

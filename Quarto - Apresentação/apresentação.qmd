---
title: "Trabalho de Amostragem"
title-slide-attributes:
    id: title-slide
    data-background-image: background.png
    data-background-size: cover
author: "Diogo, Davi, Gabriel, Giovani, João"
format:
  revealjs:
    slide-number: true
    transition: slide
    preview-links: true
    embed-resources: true
    logo: img/logo.png
    css: lecture.css
    footer: Professor Rogério Boff Borges
    background: "#FFFAFA"

---
```{r setup, include=FALSE}
# documentação do quarto: https://quarto.org/docs/presentations/revealjs/

library(tidyverse)
library(readxl)
library(grid)
library(png)
library(showtext)
library(knitr)
library(kableExtra)
library(survey)
```

```{r dados, include=FALSE}

df <- read_excel("../data/artigos.xlsx")
```

## Resumo dos dados

- **Banco de Dados:** Fora coletado o número de "artigos completos publicados em periódicos" de cada professor de estatística da UFRGS 2024/02.
As informações estão disponíveis no site do [IME da UFRGS]("https://www.ufrgs.br/ime/professores/professores-de-estatistica/") e nos respectivos [currículo Lattes]("https://lattes.cnpq.br/") dos docentes.

- **Observação:** A data de atualização dos currículos varia de acordo com cada professor o que pode nos trazes resultados subestimados.

## Definições

- **População:** Consideramos nossa população como os professores de estatística da UFRGS. Portanto temos um censo, já que a população de pesquisa é toda a população alvo. A unidade elementar consiste em cada professor que compõe o departamento.
- **Característica:** Número de artigos completos publicados em periódicos.
- **Parâmetro de interesse:** Média do número de artigos completos publicados em periódicos.

## Tabela de dados
Primeiras 10 observações da tabela:
```{r tabela de dados}

knitr::kable(head(df, 10),
  col.names = c("Nome", "Quant. Artigos"),
  align = "lr"
) %>%
  kable_styling(font_size = 23)
```

## Histograma
<span class="small-text"> Quantidade de artigos publicados por professor: </span>

```{r Histograma, warning=FALSE}
# Fonte para legenda
font_add_google("Playfair Display", "Playfair")
showtext_auto()

# Imagens para gráfico
im_suzi <- readPNG("img/foto_suzi.png")
im_patricia <- readPNG("img/foto_patricia.png")
im_alvaro <- readPNG("img/foto_alvaro.png")

ggplot(df, aes(x = quant_artigos)) +
  geom_histogram(binwidth = 8, fill = "tomato", color = "black", size = 0.8) +
  geom_curve(aes(
      x = 120, y = 1,
      xend = 109, yend = 3.5
    ),
    curvature = 0.3,
    arrow = arrow(length = unit(0.2, "inches")),
    size = 0.8,
  ) +
  geom_curve(aes(
    x = 12, y = 9.7,
    xend = 25, yend = 8
  ),
  curvature = 0.4,
  arrow = arrow(length = unit(0.2, "inches")),
  size = 0.8,
  ) +
  geom_curve(aes(
    x = 80, y = 2,
    xend = 90, yend = 7.5
  ),
  curvature = -0.4,
  arrow = arrow(length = unit(0.2, "inches")),
  size = 0.8,
  ) +
  labs(x = 'Quantidade de artigos publicados',
       y = 'Frequência') +
  annotation_raster(im_suzi, xmin = 86, xmax = 111, ymin = 2.5, ymax = 5) +
  annotation_raster(im_patricia, xmin = 91, xmax = 105, ymin = 7.5, ymax = 10) +
  annotation_raster(im_alvaro, xmin = 107, xmax = 120, ymin = 7.5, ymax = 10) +
  annotate(geom= 'text', label = "Suzi Alves Camey\ntem 120 artigos publicados", x = 98.2, y = 5.5,  size = 8, lineheight = 0.5) +
  annotate(geom= 'text', label = "41% dos pesquisadores tem\nentre 4 a 12 artigos publicados", x = 41, y = 8,  size = 8, lineheight = 0.5) +
  annotate(geom= 'text', label = "Patrícia Ziegelmann e Álvaro Vigo são o 2° e o 3°\ncom maior quantidade de publicações", x = 105, y = 10.5,  size = 8, lineheight = 0.5) +
  theme(panel.grid = element_blank(),
        panel.grid.minor = element_blank(),
        plot.background = element_rect(fill = NA),
        panel.background = element_rect(fill = NA),
        plot.title = element_text(size = 30, hjust = 0.5),
        plot.subtitle = element_text(size = 20, hjust = 0.5,lineheight = 0.5),
        axis.text = element_text(size = 15),
        axis.title.x = element_text( size = 20),
        axis.title.y = element_text( size = 20))

```

## População alvo vs População de pesquisa

## Plano amostral

- **Objetivo de Estudo**: Analisar o número de artigos completos publicados em periódicos utilizando estimadores estatísticos;
- **População alvo**: Professores do dep. de estatística da UFRGS no semestre 2024/01;
- **Coleta de dados**: Os dados são públicos e foram coletados pelo grupo através do Currículo Lattes de cada professor.

## Estimando parâmetros {background-color="#FFFAFA".scrollable}
```{r,Estimacao Parametro0, include = FALSE}
# Informações básicas do parâmetro
N <- nrow(df)
n <- 10
total_pop <- N*mean(df$quant_artigos) # Estima o total populacional!
```

### Valores populacionais

```{r, pop_param, include = FALSE}

media_pop <- mean(df$quant_artigos)
var_pop   <- var(df$quant_artigos)*(N-1)/N
```

- $\mu$  = `r media_pop`
- $\sigma^2$ = `r var_pop`

::: {.panel-tabset}
``` {r, Estimacao Parametro2, echo = FALSE}
set.seed(338357)
# Cria amostra sem reposição das linhas do dataframe, e então cria um dataframe da amostra
aass_amostra <- sample(x = seq_len(nrow(df)), size = n, replace = FALSE)
df_amostra <- df[aass_amostra, ]
df_amostra$N <- N

# Criando plano amostral a partir do survey
plano_aass <- svydesign(
  ids = ~ 1,
  fpc = ~N,
  data = df_amostra

)
```

Estimador da média

```{r, Estimacao Parametro3, echo = TRUE}
# Estimativa da Média
svymean(
  x = ~ quant_artigos,
  design = plano_aass
)
```

- Estimador da Variância
```{r, Estimacao Parametro4, echo = TRUE}
# Estimativa da Variância populacional
svyvar(
  x = ~quant_artigos,
  design = plano_aass
)
```


## Resultados


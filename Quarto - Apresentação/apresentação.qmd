---
title: "Trabalho de Amostragem"
title-slide-attributes:
    id: title-slide
    data-background-image: background.png
    data-background-size: cover
author: "Diogo, Davi, João, Gabriel e Giovani"
format:
  revealjs: 
    slide-number: true
    transition: slide
    preview-links: true
    embed-resources: true
    logo: logo.png
    css: lecture.css
    footer: Professor Rogério Boff Borges
    
---
```{r setup, include=FALSE}
library(tidyverse)
library(readxl)
library(grid)
library(png)
library(showtext)
library(knitr)
library(kableExtra)
library(survey)
```

```{r dados, include=FALSE}
df <- read_excel("../data/artigos.xlsx")
```

## Tabela de dados {background-color="#FFFAFA"}

Primeiras 10 observações da tabela:

```{r tabela de dados}

knitr::kable(head(df, 10)) %>%
  kable_styling(font_size = 17)
   
```

## Resumo dos dados
Possuímos um dataframe contendo informações sobre a quatidade de artigos publicados de 29 professores do departamento de  Estatística na UFRGS

```{r info dos dados1}
nrow(df)
```

Somando a quantidade de artigos destes professores temos 815 artigos publicados no total.

```{r info dos dados2}
sum(df$quant_artigos)
```

Claro, sabemos que muitos desses professores podem não ter atualizado seu lattes, sendo assim na realidade ter mais artigos públicados, um exemplo é o professor João Henrique Ferreira Flores, que fez doutorado, no qual é obrigatório ao menos dois artigos públicados durante o período para concluir, mas no dataframe possui apenas 1 artigo.

```{r info dos dados3}
df$nome[df$quant_artigos == 1]
```


## Histograma {background-color="#FFFAFA"}

```{r Histograma, warning=FALSE}
# Fonte para legenda
font_add_google("Playfair Display", "Playfair")
showtext_auto()

# Imagens para gráfico
img <- readPNG("img/img.png")
img2 <- readPNG("img/img2.png")
img3 <- readPNG("img/img3.png")

ggplot(df, aes(x = quant_artigos)) +
  geom_histogram(binwidth = 8, fill = "tomato", color = "black", size = 0.8) +
  geom_curve(aes(
      x = 120, y = 1, 
      xend = 109, yend = 3.5
    ),
    curvature = 0.3, 
    arrow = arrow(length = unit(0.2, "inches")),
    size = 0.8, 
  ) +
  geom_curve(aes(
    x = 12, y = 9.7, 
    xend = 25, yend = 8
  ),
  curvature = 0.4, 
  arrow = arrow(length = unit(0.2, "inches")),
  size = 0.8, 
  ) +
  geom_curve(aes(
    x = 80, y = 2, 
    xend = 90, yend = 7.5
  ),
  curvature = -0.4, 
  arrow = arrow(length = unit(0.2, "inches")),
  size = 0.8, 
  ) +
  labs(x = 'Quantidade de artigos publicados',
       y = 'Frequência',
       title = 'Quantidade de artigos publicados por professor',
       subtitle = "Quantidade de Artigos completos publicados em periódicos por\nprofessores do departamento de estatística da UFRGS") + 
  annotation_raster(img, xmin = 86, xmax = 111, ymin = 2.5, ymax = 5) +
  annotation_raster(img2, xmin = 91, xmax = 105, ymin = 7.5, ymax = 10) +
  annotation_raster(img3, xmin = 107, xmax = 120, ymin = 7.5, ymax = 10) +
  annotate(geom= 'text', label = "Suzi Alves Camey\ntem 120 artigos publicados", x = 98.2, y = 5.5, family = "Playfair", size = 6, lineheight = 0.5) +
  annotate(geom= 'text', label = "41% dos pesquisadores tem\nentre 4 a 12 artigos publicados", x = 37, y = 8, family = "Playfair", size = 6, lineheight = 0.5) +
  annotate(geom= 'text', label = "Patrícia Ziegelmann e Álvaro Vigo são o 2.º e o 3.º\ncom maior quantidade de publicações", x = 105, y = 10.5, family = "Playfair", size = 6, lineheight = 0.5) +
  theme(panel.grid = element_blank(),
        panel.grid.minor = element_blank(),
        plot.background = element_rect(fill = '#FFFAFA'),
        panel.background = element_rect(fill = '#FFFAFA'),
        plot.title = element_text(family = "Playfair",size = 30, hjust = 0.5),
        plot.subtitle = element_text(family = "Playfair",size = 20, hjust = 0.5,lineheight = 0.5),
        axis.text = element_text(size = 15),
        axis.title.x = element_text(family = "Playfair", size = 17),
        axis.title.y = element_text(family = "Playfair", size = 17))

```

## População alvo vs População de pesquisa {background-color="#FFFAFA"}

## Plano amostral {background-color="#FFFAFA"}

**OBS** **Este é um texto exemplo para ser preenchido, onde eu grifei de negrito os principais tópicos que definem o plano amostral, para utilziarmos de guia conforme nosso estudo/trabalho**

Aqui vamos detalhar nosso **Objetivo de Estudo**: --escrever aqui --

Com a nossa **população alvo**: Sendo os professores do departamento de estatística da UFGRS

Nesta pesquisa vamos utilizar o **método de amostragem** AASs (provavelmente vamos utilizar este, pois em uma conversa com Diogo lembramos o sor ter comentado quando a população é pequena é melhor utilizar processo sem reposição), utilizando o **tamanho da amostra n** (À definir)

O procedimento de **coleta de dados** foi feito a partir do curricúlo lattes dos professores do departamento.

Os métodos e ferramentas utilizados para a **análise de dados** que utilizamos foram -- escrever -- 

## Estimação de parâmetro {background-color="#FFFAFA"}
```{r}
# Informações básicas do parâmetro

N <- nrow(df) # População do dataframe
n <- 10 # 
total_pop <- N*mean(df$quant_artigos)

# Média e var pop da quantidade de artigos
mean(df$quant_artigos) # 28.10345
var(df$quant_artigos)*(N-1)/N # 805.2652 (Muito alta, averiguar dps)

# Como é amostragem AASs setando seed para teste de retirada de amostra única sem reposição
# Se quiserem retirar blz
set.seed(338357)

# Cria amostra sem reposição das linhas do dataframe, e então cria um dataframe da amostra
aass_amostra <- sample(x = seq_len(nrow(df)), size = n, replace = FALSE)
df_amostra <- df[aass_amostra, ]
df_amostra$N <- N

# Vou fazer o cálculo utilizando o pacote Survey 
plano_aass <- svydesign(
  ids = ~ 1,
  fpc = ~N,
  data = df_amostra

)

# Estimativa da media e variância populacional
svymean(
  x = ~ quant_artigos,
  design = plano_aass
)

svyvar(
  x = ~quant_artigos,
  design = plano_aass
)
```


## Resultados {background-color="#FFFAFA"}

